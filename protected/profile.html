<html>
    <head>
        <title>profile</title>
        <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="profile.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.3.2/chart.min.js" integrity="sha512-VCHVc5miKoln972iJPvkQrUYYq7XpxXzvqNfiul1H4aZDwGBGC0lq373KNleaB2LpnC2a/iNfE5zoRYmB4TRDQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    </head>
    <body>
        <div id="mainContent" class="container-fluid">
            <div id = "header" class="row">
                <div id = "topic" class="col-md-6">
                    <h3> MasterMind: Profile Page</h3>
                </div>
            </div>
            <div id = "profile" class="card mb-3" style="max-width: 540px;">
                <div class="row g-0">
                  <div class="col-md-4">

                    <img id="pic" alt="user">
                    <div id="uploadMessage"></div>

                  </div>
                  <div class="col-md-8">
                    <div class="card-body" >

                      <div id = "profileInfo" class="profileInfo_show">


                      <h5 id = "username" class="card-title"></h5>

                      <form class="form-group" 
                        action="/profilePic" 
                        method="POST" 
                        id = "uploadPic"
                        enctype="multipart/form-data">

                        <label for="profilePic">upload profile picture</label>
                        <input type="file" name="image" id="file" >
                        <div id = "setProfilePic" class = "flex-container">
                        <input type="submit" /> 
                        <button type="button" onclick="deletePic()">delete picture</button>
                        </div>
                        </form>

                        <div class="flex-container">
                          <button type="button" class="btn btn-primary" onclick="changeUsername()" >change username</button>
                          <button type="button" class="btn btn-primary" onclick="changePassword()">change password</button>
                        </div>


                      </div>
                    
                      <div id="updateUsername" class = "updateUsername_hide">
                        <form  id = "updateUsernameForm" action="/changeUsername" method="PUT">
                          <p><label for="newUsername"><b>Enter new user name:</b></label><br></p>
                          <p><input type="text" id="newUsername" name="newUsername"><br></p>
                         <p> <input type="submit" class="button" value="Change user name"></input></p>

                        </form>
                        <button id = "cancelChange" onclick="cancelChange()"> cancel</button>
                      </div>
                      
                     <div id = "confirmPassword"class = "confirmPassword_hide">
                       <form id = "confirmPasswordForm" action="/confirmPassword" method="GET">
                        <p><b>Please enter your password to proceed to the next step.</b></p>
                        <p><label for="password"><b>Password:</b></label><br></p>
                        <p><input type="password" id="password" name="password" required></p>
                        <p> <input type="submit" class="button" value="confirm"></input></p>
                      </form>
                      <button id = "cancelChange" onclick="cancelChange()"> cancel</button>
                      <div id = "confirmMessage"></div>
                     </div>


                      <div id="updatePassword"class = "updatePassword_hide">
                        <form  id="updatePasswordForm" action="/changePassword" method="PUT">
                          <label for="newPassword"><b>Enter your new password:</b></label><br>
                          <input type="password" id="newPassword" name="newPassword"><br>
                          <label for="conPassword"><b>Confirm your new password:</b></label><br>
                          <input type="password" id="conPassword" name="conPassword"><br>
                         <input type="submit" class="button" value="Change password"></input>
                        </form>
                         <button id = "cancelChange" onclick="cancelChange()"> cancel</button>
                         <div id = "newPasswordMessage"></div>
                      </div>

                    </div>
                  </div>
                </div>
            </div>
            <div id = "histories">
              <div id ="historiesButton">
                <div class = "clear histories">
                    <button type="button" class="btn btn-primary" onclick = "deleteHistory()">clear histories</button>
                </div>
                <div id ="popUp">
                  <button type="button" class="btn btn-primary" onclick='openPrefer()'>
                    Prefer Color
                </button>
                <div class="modal fade" id="preferColor" tabindex="-1" aria-labelledby="exampleModalLabel" aria-modal="true"
                    role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Performance</h5>
                                <button type="button" class="close" aria-label="Close" onclick="closeModal()">
                                    <span aria-hidden="true">X</span>
                                </button>
                            </div>
                            <div class="modal-body">
                              <canvas id="preferChart" width="400" height="400"></canvas>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" onclick="closeModal()">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-backdrop fade show" id="backdrop" style="display: none;"></div>
                </div>
                <div id ="popUp">
                  <button type="button" class="btn btn-primary" onclick='openHitRate()'>
                    Hit Rate
                </button>
                <div class="modal fade" id="hitRate" tabindex="-1" aria-labelledby="exampleModalLabel" aria-modal="true"
                    role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Hit Rate</h5>
                                <button type="button" class="close" aria-label="Close" onclick="closeModal()">
                                    <span aria-hidden="true">X</span>
                                </button>
                            </div>
                            <div class="modal-body">
                              <canvas id="hitRateChart" width="400" height="400"></canvas>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" onclick="closeModal()">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-backdrop fade show" id="backdrop" style="display: none;"></div>
                </div>
                <div id ="popUp">
                  <button type="button" class="btn btn-primary" onclick='openPerformance()'>
                    Performance
                </button>
                <div class="modal fade" id="performance" tabindex="-1" aria-labelledby="exampleModalLabel" aria-modal="true"
                    role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Hit Rate</h5>
                                <button type="button" class="close" aria-label="Close" onclick="closeModal()">
                                    <span aria-hidden="true">X</span>
                                </button>
                            </div>
                            <div class="modal-body">
                              <canvas id="performanceChart" width="400" height="400"></canvas>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" onclick="closeModal()">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-backdrop fade show" id="backdrop" style="display: none;"></div>
                </div>
              </div>
                <div class = "histories table">
                    <table class="table table-success table-striped">
                        <thead>
                          <tr>
                            <th scope="col">Date</th>
                            <th scope="col">Win/Lose</th>
                            <th scope="col">Number of Rounds</th>
                            <th scope="col">answer</th>
                            
                          </tr>
                        </thead>
                        <tbody id = "historyList"></tbody>
                          
                        
                      </table>
    
                </div>
                <div class="flex-container" id = "back">
                <a class="btn btn-primary" href="/gameRoom" role="button">back to game</a>
                <a class="btn btn-outline-primary" href="/logout" role="button">logout</a>
              </div>
            </div>
              


        </div>
        <script src="piechart.js"></script>
        <script src="profile.js"></script>
        <!-- JavaScript Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
    </body>
</html>